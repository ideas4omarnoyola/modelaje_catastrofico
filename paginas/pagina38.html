<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Página 38</title>

    <!-- Estilos -->
    <link rel="stylesheet" href="../css/estilos.css">

    <!-- Librerias -->
    <script src="../js/librerias/jquery.min.js"></script>
    <script src="../js/librerias/jquery-ui.min.js"></script>
    <script src="../js/librerias/jquery.ui.touch-punch.min.js"></script>
    <script src="../js/librerias/gsap.min.js"></script>

    <!-- Script de animaciones -->
    <script src="../js/animaciones.js"></script>
    <!-- Scripts posicionar elementos -->
    <script src="../js/redimensionarElementos.js"></script>
    <script src="../js/posicionar.js"></script>

</head>
<body class="pagina">

    <img class="elementos" id="fondoActividad" src="../img/pagina38/fondoActividad.png" data-posX="0" data-posY="0" alt="">

    <div class="elementos drops" data-lugar="1" id="drop1" data-posX="106" data-posY="192" alt=""></div>
    <div class="elementos drops" data-lugar="2" id="drop2" data-posX="394" data-posY="192" alt=""></div>
    <div class="elementos drops" data-lugar="3" id="drop3" data-posX="679" data-posY="192" alt=""></div>

    <img class="elementos drags" id="drag1" data-lugar="1" data-pos="1" src="../img/pagina38/drag1.png" data-posX="141" data-posY="409" alt="">    
    <img class="elementos drags" id="drag2" data-lugar="1" data-pos="2" src="../img/pagina38/drag2.png" data-posX="294" data-posY="409" alt="">    
    <img class="elementos drags" id="drag3" data-lugar="3" data-pos="3" src="../img/pagina38/drag3.png" data-posX="448" data-posY="409" alt="">
    <img class="elementos drags" id="drag4" data-lugar="1" data-pos="4" src="../img/pagina38/drag4.png" data-posX="601" data-posY="409" alt="">    
    <img class="elementos drags" id="drag5" data-lugar="1" data-pos="5" src="../img/pagina38/drag5.png" data-posX="754" data-posY="409" alt="">

    <img class="elementos info" id="boton1" data-pop="1" src="../img/pagina38/mas.png" data-posX="106" data-posY="518" alt="">    
    <img class="elementos info" id="boton2" data-pop="2" src="../img/pagina38/mas.png" data-posX="262" data-posY="518" alt="">    
    <img class="elementos info" id="boton3" data-pop="3" src="../img/pagina38/mas.png" data-posX="415" data-posY="518" alt="">
    <img class="elementos info" id="boton4" data-pop="4" src="../img/pagina38/mas.png" data-posX="568" data-posY="518" alt="">    
    <img class="elementos info" id="boton5" data-pop="5" src="../img/pagina38/mas.png" data-posX="721" data-posY="518" alt="">

    <img class="elementos" id="pop1" src="../img/pagina38/pop1.png" data-posX="0" data-posY="0" alt="">    
    <img class="elementos" id="pop2" src="../img/pagina38/pop2.png" data-posX="0" data-posY="0" alt="">    
    <img class="elementos" id="pop3" src="../img/pagina38/pop3.png" data-posX="0" data-posY="0" alt="">
    <img class="elementos" id="pop4" src="../img/pagina38/pop4.png" data-posX="0" data-posY="0" alt="">    
    <img class="elementos" id="pop5" src="../img/pagina38/pop5.png" data-posX="0" data-posY="0" alt="">
    
    <img class="elementos botonCerrar" id="cerrar1" data-pop="1" src="../img/pagina38/cerrar.png" data-posX="891" data-posY="114" alt="">    
    <img class="elementos botonCerrar" id="cerrar2" data-pop="2" src="../img/pagina38/cerrar.png" data-posX="891" data-posY="114" alt="">    
    <img class="elementos botonCerrar" id="cerrar3" data-pop="3" src="../img/pagina38/cerrar.png" data-posX="891" data-posY="114" alt="">
    <img class="elementos botonCerrar" id="cerrar4" data-pop="4" src="../img/pagina38/cerrar.png" data-posX="891" data-posY="114" alt="">    
    <img class="elementos botonCerrar" id="cerrar5" data-pop="5" src="../img/pagina38/cerrar.png" data-posX="891" data-posY="114" alt="">

    <img class="elementos" id="retroBuena" src="../img/pagina38/retroBuena.png" data-posX="0" data-posY="0" alt="">


    <!-- Script de la página -->
    <script>

        // Variable----------------------------------------------------
        let aplicacion = parent;

        const fondoActividad = $('#fondoActividad');

        const cerrar1 = $('#cerrar1');
        const cerrar2 = $('#cerrar2');
        const cerrar3 = $('#cerrar3');
        const cerrar4 = $('#cerrar4');
        const cerrar5 = $('#cerrar5');

        const pop1 = $('#pop1');
        const pop2 = $('#pop2');
        const pop3 = $('#pop3');
        const pop4 = $('#pop4');
        const pop5 = $('#pop5');

        const boton1 = $('#boton1');
        const boton2 = $('#boton2');
        const boton3 = $('#boton3');
        const boton4 = $('#boton4');
        const boton5 = $('#boton5');

        const drag1 = $('#drag1');
        const drag2 = $('#drag2');
        const drag3 = $('#drag3');
        const drag4 = $('#drag4');
        const drag5 = $('#drag5');

        const drags = $('.drags');
        const drops = $('.drops');
        const info = $('.info');
        const botonCerrar = $('.botonCerrar');

        const retroBuena = $('#retroBuena');

        drops.css({
            'background': 'green',
            'width': '226px',
            'height': '206px'
        });

        info.css({
            'cursor': 'pointer'
        });

        const pops = [pop1, pop2, pop3, pop4, pop5];
        const botonesCerrar = [cerrar1, cerrar2, cerrar3, cerrar4, cerrar5];

        let dragSelect;
        let dropSelect;
        let notaActiva;

        let colocados = 0;

        // Audios------------------------------------------------------
        const audio = [
            
        ]

        // Al cargarse la página
        $(window).on("load", function(){
            redimensionarElementos();
            aplicacion.cargando(iniciarContenido);
        });

        function iniciarContenido(){
            entradaActividad();
        }

        function entradaActividad() {  
            animacionEntrada(fondoActividad, 'default', 1, 1);
            animacionEntrada(drag1, 'abajo-arriba', 1, 1.5);
            animacionEntrada(drag2, 'abajo-arriba', 1, 2);
            animacionEntrada(drag3, 'abajo-arriba', 1, 2.5);
            animacionEntrada(drag4, 'abajo-arriba', 1, 3);
            animacionEntrada(drag5, 'abajo-arriba', 1, 3.5);
            animacionEntrada(drops, 'default', 1, 4);
            animacionEntrada(info, 'default', 1, 4);

            setTimeout(()=>{
                completarOraciones();
                drags.css('cursor', 'grab');
            }, 4000);
        }

        info.each(function(){
            $(this).click(function(){
                if($(this).css('cursor') == 'pointer'){
                    const indexPop = Number($(this).data('pop'));
                    animacionEntrada(pops[indexPop - 1], 'default', 1);
                    parpadear(botonesCerrar[indexPop - 1])
                }
            });
        });

        botonCerrar.each(function(){
            $(this).click(function(){
                if($(this).css('cursor') == 'pointer'){
                    const indexPop = Number($(this).data('pop'));
                    dejarParpadear($(this));
                    animacionSalida(pops[indexPop -1], 'default', 1);
                    animacionSalida($(this), 'default', 1);
                }
            });
        });

        function completarOraciones(){

            drags.draggable({
                revert: true,
                start: function( event, ui ) {
                    notaActiva = $(this).data('pos');
                    dragSelect = $(this).data('lugar');
                }
            });

            drops.droppable({
                accept: drags,
                tolerance: "intersect",
                drop: function( event, ui ) {
                    dropSelect = $(this).data('lugar');
                    soltar();
                }
            });
        }

        function soltar(){
            // Selecionar los elementos correspondiente
            const dragActivo = $(`#drag${notaActiva}`);

            if (dragSelect === dropSelect) {

                //Deshabilitar el regreso
                dragActivo.draggable({
                    revert: false,
                });
                dragActivo.draggable("disable");

                if(dragActivo.data('pos') == 1){
                    dragActivo.css({
                        'left': '90px',
                        'top': '160px'
                    });
                }

                if(dragActivo.data('pos') == 2){
                    dragActivo.css({
                        'left': '200px',
                        'top': '160px'
                    });
                }

                if(dragActivo.data('pos') == 4){
                    dragActivo.css({
                        'left': '90px',
                        'top': '250px'
                    });
                }

                if(dragActivo.data('pos') == 5){
                    dragActivo.css({
                        'left': '200px',
                        'top': '250px'
                    });
                }

                dragActivo.css({
                    'cursor': 'default',
                    'transform': 'scale(.6)'
                });

                colocados++;
            }

            if(colocados == 5){
                finalActividad();
            }
        }
        
        function finalActividad(){
            animacionEntrada(retroBuena, 'default', 1);
            aplicacion.terminaPantalla();
        }

    </script>
</body>
</html>